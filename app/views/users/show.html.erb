<h1><%= @user.name %> (<%= @user.username %>)</h1>

<% if logged_in? and @user != current_user %>
  <%= link_to 'Send a message', new_message_path(:recipient => @user.username) %>
<% end %>

<p><%= @user.profile.bio %></p>

<% if @user.profile.website.present? %>
  Website: <%= link_to @user.profile.website, @user.profile.website %>
<% end %>

<% if @user.profile.twitter.present? %>
  Twitter: <%= link_to @user.profile.twitter, "http://twitter.com/#{@user.profile.twitter.gsub(/^@/, '')}" %>
<% end %>

<h2>Challenges attempted</h2>

<% @user.attempts.each do |attempt| %>
  <div>
    <%= link_to attempt.challenge.title, attempt.challenge %> 
    <% if @user == current_user and attempt.challenge.open? %>
      <%= link_to 'Edit your entry', edit_challenge_attempt_path(attempt.challenge, attempt) %>
    <% end %>
  </div>
<% end %>

<% if @user == current_user and current_user.reviewer? %>
  <h2>Pending Reviews (<%= current_user.reviews.pending.count %>)</h2>
  
  <% @user.reviews.pending.each do |review| %>
    <div>
      <%= link_to "Attempt #{review.attempt.id}", [review.challenge, review.attempt] %> 
      on <%= link_to review.challenge.title, review.challenge %> 
      attempt by <%= link_to review.attempt.user.name, review.attempt.user %> (<%= review.attempt.user.username %>)
    </div>
  <% end %>
<% end %>